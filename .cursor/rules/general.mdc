---
alwaysApply: true
description: general rules to apply on react-native projects
---

# React Native Conditional Rendering Safety Rules

## âš ï¸ NEVER use numbers in conditional rendering - they can render as "0"

### âŒ DANGEROUS PATTERNS (will cause "Text strings must be rendered within <Text> component"):

```tsx
{
  number && <Component />;
} // 0 renders as text!
{
  array.length && <Component />;
} // 0 renders as text!
{
  count && <Component />;
} // 0 renders as text!
{
  usdPrice && <Component />;
} // 0 renders as text!
{
  balance && <Component />;
} // 0 renders as text!
```

### âœ… SAFE PATTERNS (always use these):

```tsx
{
  number > 0 && <Component />;
} // boolean result
{
  array.length > 0 && <Component />;
} // boolean result
{
  count > 0 && <Component />;
} // boolean result
{
  usdPrice > 0 && <Component />;
} // boolean result
{
  balance > 0 && <Component />;
} // boolean result
{
  Boolean(number) && <Component />;
} // explicit boolean conversion
{
  !!number && <Component />;
} // double negation to boolean
```

## ğŸ¯ RULES FOR CONDITIONAL RENDERING:

1. **Always use comparison operators** with numbers: `>`, `>=`, `<`, `<=`, `===`, `!==`
2. **Never use numbers directly** in && conditions
3. **Use Boolean()** or !! for explicit boolean conversion
4. **Test edge cases** where values might be 0, null, undefined
5. **Use optional chaining** safely: `obj?.prop > 0 && <Component />`

## ğŸ“± REACT NATIVE SPECIFIC:

### âœ… Safe Text Component Usage:

```tsx
<Text>{someValue}</Text>              // Safe - explicit Text wrapper
<Text>{number.toString()}</Text>      // Safe - explicit string conversion
<Text>{`${number}`}</Text>            // Safe - template literal
```

### âŒ Never render values directly:

```tsx
{
  someValue;
} // Dangerous if not Text component
{
  number;
} // Will cause error
```

## ğŸ§ª TESTING CHECKLIST:

Before committing, test these edge cases:

- [ ] What happens when number = 0?
- [ ] What happens when array.length = 0?
- [ ] What happens when usdPrice = 0?
- [ ] What happens when balance = 0?

## ğŸš€ FOLLOW THESE PATTERNS:

1. **For numbers**: `{value > 0 && <Component />}`
2. **For arrays**: `{array.length > 0 && <Component />}`
3. **For booleans**: `{isCondition && <Component />}` (already safe)
4. **For strings**: `{string && <Component />}` (safe - empty string is falsy)
5. **For objects**: `{object && <Component />}` (safe - null/undefined are falsy)

Remember: **React renders 0 as text, but doesn't render false/null/undefined**

---

## ğŸ¯ ADDITIONAL CODING STANDARDS:

### âœ… File Naming Convention:

- **Always use kebab-case**: `user-profile.tsx`, `send-token.ts`, `profile-api.ts`
- **Never use camelCase**: âŒ `userProfile.tsx`, âŒ `sendToken.ts`

### âœ… Component Structure:

- **Keep components under 200 lines**
- **Extract logic into custom hooks**
- **One responsibility per component**

### âœ… Import Organization:

```tsx
// 1. External libraries
import React from "react";
import { View } from "react-native";

// 2. Internal components
import { Button } from "~/components/button";

// 3. Types
import type { IUser } from "./types";
```

### âœ… Error Handling:

```tsx
// Always handle potential errors
try {
  await apiCall();
} catch (error) {
  console.error("Specific operation failed:", error);
  // Show user-friendly message
}
```

### âœ… Type Safety:

```tsx
// Always validate data before using
if (!data || typeof data !== "string") {
  throw new Error("Invalid data type");
}
```

### ğŸš« NEVER DO:

- âŒ Render numbers directly in JSX
- âŒ Use camelCase file names
- âŒ Create files over 300 lines
- âŒ Use any without explicit typing
- âŒ Ignore error handling

### ğŸ’¡ REMEMBER:

Your employer will be very unhappy if code doesn't work. Always prioritize:

1. **Reliability** over performance
2. **Type safety** over convenience
3. **Error handling** over clean code
4. **Testing** edge cases thoroughly

---

## ğŸ”¥ CRITICAL REACT NATIVE RULES:

### âœ… Text Component Safety:

```tsx
// âœ… ALWAYS wrap text/numbers in <Text>
<Text>{value}</Text>
<Text>{number.toString()}</Text>
<Text>{`${value}`}</Text>

// âŒ NEVER render directly
{value}
{number}
```

### âœ… Conditional Rendering:

```tsx
// âœ… SAFE - boolean results
{
  value > 0 && <Component />;
}
{
  array.length > 0 && <Component />;
}
{
  Boolean(value) && <Component />;
}
{
  !!value && <Component />;
}

// âŒ DANGEROUS - can render 0
{
  value && <Component />;
}
{
  array.length && <Component />;
}
```

### âœ… Component Size Limits:

- **React Native components**: max 200 lines
- **Hooks**: max 150 lines
- **Utilities**: max 100 lines
- **If larger**: decompose into smaller components

### âœ… State Management:

```tsx
// âœ… SAFE - with null checks
const safeValue = data?.value || 0;
if (safeValue > 0) {
  // use safeValue
}

// âŒ DANGEROUS - no protection
{
  data.value && <Component />;
}
```

### ğŸ¯ AUTO-LINT RULES:

When writing conditional rendering, AI should automatically:

1. Check if condition can be 0/number
2. Convert to boolean comparison
3. Add explicit type checking
4. Wrap all text in <Text> components

**FOLLOW THESE RULES RELIGIOUSLY - NO EXCEPTIONS!**

---

## ğŸŒ SOPHON PROJECT SPECIFIC RULES:

### âœ… Web3 Address Validation:

```tsx
// âœ… ALWAYS validate addresses
const isValidAddress = (addr: string) => {
  return addr && addr.startsWith("0x") && addr.length === 42;
};

// âœ… SAFE address rendering
{
  address && (
    <Text>
      {address.slice(0, 6)}...{address.slice(-4)}
    </Text>
  );
}

// âŒ NEVER render address directly
{
  address;
} // Can be undefined!
```

### âœ… Token Amount Safety:

```tsx
// âœ… SAFE amount handling
const amount = Number.parseFloat(token.amount || "0");
{
  amount > 0 && <Component />;
}

// âŒ DANGEROUS
{
  token.amount && <Component />;
} // Can be "0"!
```

### âœ… USD Value Display:

```tsx
// âœ… SAFE USD rendering
{
  usdValue > 0 && <Text>${usdValue.toFixed(2)}</Text>;
}

// âŒ DANGEROUS
{
  usdValue && <Text>...</Text>;
} // Can render 0!
```

### âœ… Balance Checks:

```tsx
// âœ… SAFE balance validation
const hasBalance = Number.parseFloat(balance) > 0;
{
  hasBalance && <SendButton />;
}

// âŒ DANGEROUS
{
  balance && <SendButton />;
} // Can be "0"!
```

### ğŸ¯ Sophon Token Constants:

- Always import from `~/features/web3/constants/tokens`
- Use `SOPH_TOKEN` for native token
- Use `SUPPORTED_TOKENS` for token list

### ğŸ” Transaction Safety:

```tsx
// âœ… ALWAYS capture transaction data
const txData = {
  token: formData.selectedToken,
  recipientAddress: formData.recipientAddress,
  amount: formData.amount,
};

// âœ… ALWAYS validate before sending
if (!txData.token || !txData.recipientAddress || !txData.amount) {
  throw new Error("Missing transaction data");
}
```

### ğŸ“ Console Logging:

```tsx
// âœ… SAFE reactotron logging
if (console.tron) {
  console.tron.log("Safe message", data);
}

// âŒ DANGEROUS direct console.tron
console.tron.log("message"); // Can break if tron not available
```

**REMEMBER: Web3 + React Native = Double the care needed!**
